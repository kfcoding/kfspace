(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{301:function(e,t,n){e.exports=n(698)},306:function(e,t,n){},308:function(e,t,n){},631:function(e,t){},647:function(e,t){},649:function(e,t){},653:function(e,t){},655:function(e,t){},657:function(e,t){},672:function(e,t){},674:function(e,t){},698:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(11),o=n.n(i),c=(n(306),n(12)),s=n(13),l=n(26),u=n(17),p=n(25),f=n(708),d=n(709),h=(n(308),n(169)),m=n.n(h),b=n(125),v=n.n(b),g=n(62),y=n.n(g),j=n(41),O=n.n(j),x=n(276),k=n.n(x),E=n(277),S=n.n(E),w=n(706),D=n(23),C=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a)))).state={title:"",description:""},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.scenario;return a.a.createElement(y.a.Item,null,a.a.createElement(y.a.Item.Meta,{title:e.title,description:e.description}),a.a.createElement("div",null,a.a.createElement(O.a,{type:"primary"},a.a.createElement(w.a,{to:"/scenarios/"+encodeURIComponent(this.props.sdir)},"\u5f00\u59cb\u5b9e\u8bad"))))}}]),t}(r.Component),I=(Object(D.b)("store")(C),function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a)))).state={title:"",author:"",description:"",scenarios:[],course:{}},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){}},{key:"goto",value:function(e){this.props.store.setCurrentScenario(e),this.props.store.setPage("scenario")}},{key:"render",value:function(){var e=this,t=this.props.store.course;return a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"banner"},a.a.createElement("h1",null,t.title),a.a.createElement("h2",null,"\u4f5c\u8005: ",t.author),a.a.createElement("h3",null,t.description)),a.a.createElement("div",{style:{padding:"40px 40px"}},a.a.createElement(m.a,{gutter:24},a.a.createElement(v.a,{span:18},a.a.createElement(y.a,null,t.scenarios.map(function(t){return a.a.createElement(y.a.Item,{key:t},a.a.createElement(y.a.Item.Meta,{title:t.title,description:t.description}),a.a.createElement("div",null,a.a.createElement(O.a,{type:"primary",onClick:function(){e.goto(t)}},"\u5f00\u59cb\u5b9e\u8bad")))}))),a.a.createElement(v.a,{span:6},a.a.createElement(k.a,{title:"\u8bfe\u7a0b\u4fe1\u606f"},a.a.createElement("div",null,"\u5b9e\u8bad\u6570\u91cf\uff1a",t.scenarios.length),"\u5b8c\u6210\u60c5\u51b5\uff1a",a.a.createElement(S.a,{type:"circle",percent:0}))))))}}]),t}(r.Component)),T=Object(D.b)("store")(Object(D.c)(I)),A=n(281),P=n.n(A),z=n(171),B=n.n(z),J=n(173),N=n.n(J),M=n(278),F=n.n(M),R=n(279),L=n.n(R);n(502);N.a.registerLanguage("js",L.a);var G=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return F()(this,e,t)}},{key:"render",value:function(){return a.a.createElement(N.a,{language:this.props.language||"js",value:this.props.value,inline:this.props.inline})}}]),t}(a.a.Component),H=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a)))).state={source:"123"},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement(B.a,{source:this.props.step.text,renderers:{inlineCode:G,code:G}}))}}]),t}(r.Component),U=Object(D.b)("store")(Object(D.c)(H)),q=n(280),W=n(174),$=n.n(W),K=n(283),Q=n.n(K),V=n(30),X=n.n(V),Y=(n(505),n(513),n(97)),Z=n(126);Y.Terminal.applyAddon(Z);var _=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).resize=function(){},n.dom=a.a.createRef(),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.store.currentScenario.terminals[0].terminal.open(this.dom),this.props.store.currentScenario.terminals[0].terminal.fit()}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{ref:function(t){return e.dom=t},style:{width:"100%",height:"100%"}})}}]),t}(a.a.Component),ee=Object(D.b)("store")(_),te=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"modal",value:function(){P.a.info({title:this.props.store.currentScenario.title,content:a.a.createElement("div",null,this.props.store.currentScenario.description),onOk:function(){}})}},{key:"render",value:function(){var e=this,t=this.props.store.currentScenario;return a.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%"}},a.a.createElement("div",{style:{height:60,background:"#00b7ef",flexShrink:0}},a.a.createElement(X.a,{type:"book",theme:"twoTone",style:{fontSize:40,lineHeight:"60px",cursor:"pointer"},onClick:function(){e.props.store.setPage("")}})),a.a.createElement("div",{style:{flexGrow:1,flexShrink:1,overflow:"hidden",position:"relative"}},a.a.createElement(q.a,{split:"vertical",minSize:50,defaultSize:480,style:{}},a.a.createElement("div",null,a.a.createElement("div",{style:{height:40,lineHeight:"40px",textAlign:"center",fontSize:24,background:"#2f7aa7",color:"#fff"}},t.title),a.a.createElement("div",{style:{padding:20}},t.steps.length>0&&a.a.createElement("div",null,a.a.createElement(U,{step:t.steps[this.props.store.stepIndex]}),a.a.createElement("div",{style:{textAlign:"right"}},a.a.createElement(O.a.Group,null,0!=this.props.store.stepIndex&&a.a.createElement(O.a,{type:"default",onClick:function(){e.props.store.prevStep()}},a.a.createElement(X.a,{type:"left"}),"\u4e0a\u4e00\u6b65"),this.props.store.stepIndex!=t.steps.length-1&&a.a.createElement(O.a,{type:"primary",onClick:function(){e.props.store.nextStep()}},"\u4e0b\u4e00\u6b65",a.a.createElement(X.a,{type:"right"}))))))),a.a.createElement("div",{style:{height:"100%"}},a.a.createElement(ee,null)))),a.a.createElement("div",{style:{background:"#fff",flexShrink:0,borderTop:"1px solid #ccc",paddingTop:20}},a.a.createElement($.a,{current:this.props.store.stepIndex+1,progressDot:function(e,n){n.status;var r=n.index;return a.a.createElement(Q.a,{content:a.a.createElement("span",null,"\u7b2c",r,"\u6b65: ",t.steps[r-1].description)},e)},initial:1},t.steps.map(function(e){return a.a.createElement($.a.Step,{key:e,title:e.title})}))))}}]),t}(r.Component),ne=Object(D.b)("store")(Object(D.c)(te)),re=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.store.fetchCourse(decodeURIComponent(this.props.match.params.repo)).then(function(){e.props.store.setLoading(!1)})}},{key:"render",value:function(){return a.a.createElement("div",{style:{height:"100%"}},""==this.props.store.page?a.a.createElement(T,null):a.a.createElement(ne,null))}}]),t}(r.Component),ae=Object(D.b)("store")(Object(D.c)(re)),ie=n(284),oe=n.n(ie),ce=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return a.a.createElement(oe.a,{loading:this.props.store.loading,bgColor:"#39a189",spinnerColor:"#9ee5f8",textColor:"#fff",logoSrc:"/giphy.gif",text:"Loading...",style:{height:"100%"}},a.a.createElement(f.a,null,a.a.createElement("div",{style:{height:"100%"}},a.a.createElement(d.a,{path:"/kfspace/:repo",component:ae}))))}}]),t}(r.Component),se=Object(D.b)("store")(Object(D.c)(ce));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var le=n(2),ue=n.n(le),pe=n(15),fe=n(3),de=pe.e.model("Step",{dir:"",title:"",description:"",text:""}).volatile(function(e){return{textDir:""}}).actions(function(e){return{afterCreate:function(){},setDir:function(t){e.dir=t},setTitle:function(t){e.title=t},setDescription:function(t){e.description=t},setTextDir:function(t){e.textDir=t},fetchText:Object(pe.a)(ue.a.mark(function t(){var n;return ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(pe.c)(e).pfs.readFile(Object(pe.b)(Object(pe.b)(e)).dir+"/"+e.dir+"/"+e.textDir);case 2:n=t.sent,e.text=n.toString();case 4:case"end":return t.stop()}},t,this)}))}}),he=n(172),me=n.n(he);Y.Terminal.applyAddon(Z);var be=pe.e.model("Terminal",{name:"tt"}).volatile(function(e){return{terminal:{}}}).views(function(e){return{get store(){return Object(pe.c)(e)}}}).actions(function(e){var t=null,n=null;return{exc:function(t){var r,a=t.split(".");"cpp"===a[a.length-1]?r="g++ "+t+" -o /tmp/out.o && /tmp/out.o\n":"py"===a[a.length-1]?r="python "+t+"\n":alert("\u4e0d\u662f\u5408\u6cd5\u6587\u4ef6"),n.emit("term.input",{id:e.id,input:r})},afterCreate:function(){n=Object(pe.b)(e,2).socket,t=new Y.Terminal({fontSize:16}),e.terminal=t,t.on("key",function(e,t){n.emit("data",{host:"HOST1",data:e})}),t.on("resize",function(e){var t=e.cols,r=e.rows;n.emit("terminal-resize",{cols:t,rows:r})})},beforeDestroy:function(){n.emit("term.close",{id:e.id})}}}),ve=pe.e.model("Scenario",{dir:pe.e.identifier,title:"",description:"",steps:pe.e.array(de),terminals:pe.e.array(be)}).volatile(function(e){return{stepDirs:[],socket:me.a.connect("//ws.katacoda.com",{transports:["websocket"],timeout:12e4,reconnection:!1,query:"dockerimage=dind&course=docker&id=deploying-first-container&originalPathwayId="})}}).actions(function(e){Object(pe.a)(ue.a.mark(function e(){var t,n;return ue.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://api.kfcoding.com/api/basic/workspaces",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({dockerImage:"registry-vpc.cn-shanghai.aliyuncs.com/kfcoding/workspace-envs:ubuntu",type:"terminal"})});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,console.log(n);case 7:case"end":return e.stop()}},e,this)}));return{afterCreate:function(){e.terminals.push({}),e.socket.on("data",function(t){console.log(t),e.terminals[0].terminal.write(t.data)})},setDir:function(t){e.dir=t},setTitle:function(t){e.title=t},setDescription:function(t){e.description=t},setStepDirs:function(t){e.stepDirs=t},setTerminal:function(t){e.terminal=t},fetchSteps:Object(pe.a)(ue.a.mark(function t(){var n,r,a,i,o;return ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=ue.a.keys(e.stepDirs);case 1:if((t.t1=t.t0()).done){t.next=21;break}return n=t.t1.value,t.prev=3,r=e.stepDirs[n],t.next=7,Object(pe.c)(e).pfs.readFile(e.dir+"/"+r+"/config.json");case 7:return a=t.sent,i=JSON.parse(a.toString()),(o=de.create({dir:r,title:i.title,description:i.description})).setTextDir(i.text),e.steps.push(o),t.next=14,o.fetchText();case 14:t.next=19;break;case 16:t.prev=16,t.t2=t.catch(3),console.error(t.t2);case 19:t.next=1;break;case 21:case"end":return t.stop()}},t,this,[[3,16]])}))}}),ge=pe.e.model("Course",{title:"",description:"",author:"",scenarios:pe.e.array(ve)}).volatile(function(e){return{scenarioDirs:[]}}).actions(function(e){return{afterCreate:function(){},setTitle:function(t){e.title=t},setDescription:function(t){e.description=t},setAuthor:function(t){e.author=t},addScenario:function(t){e.scenarios.push(t)},setScenarioDirs:function(t){e.scenarioDirs=t},fetchScenarios:Object(pe.a)(ue.a.mark(function t(){var n,r,a,i,o;return ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.scenarios=[],t.t0=ue.a.keys(e.scenarioDirs);case 2:if((t.t1=t.t0()).done){t.next=20;break}return n=t.t1.value,t.prev=4,r=e.scenarioDirs[n],t.next=8,Object(pe.c)(e).pfs.readFile(r+"/config.json");case 8:a=t.sent,i=JSON.parse(a.toString()),(o=ve.create({dir:r,title:i.title,description:i.description})).setStepDirs(i.steps),e.scenarios.push(o),t.next=18;break;case 15:t.prev=15,t.t2=t.catch(4),console.error(t.t2);case 18:t.next=2;break;case 20:Promise.all(e.scenarios.map(function(){var e=Object(fe.a)(ue.a.mark(function e(t){return ue.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchSteps();case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 21:case"end":return t.stop()}},t,this,[[4,15]])}))}}),ye=n(239),je=pe.e.model("Store",{loading:!0,repo:"https://github.com/kfcoding/kfcoding-cource-example.git",course:pe.e.optional(ge,{}),hasCurrentScenario:!1,currentScenario:pe.e.maybe(pe.e.reference(ve)),stepIndex:0,currentStep:pe.e.maybe(pe.e.reference(de)),page:""}).volatile(function(e){return{bfs:null,pfs:null}}).actions(function(e){return{setBfs:function(t){e.bfs=t},setPfs:function(t){e.pfs=t},setRepo:function(t){e.repo=t},setCurrentScenario:function(t){e.currentScenario=t},setLoading:function(t){e.loading=t},setStepIndex:function(t){e.stepIndex=t},setPage:function(t){e.page=t},nextStep:function(){e.stepIndex++},prevStep:function(){e.stepIndex--},fetchGit:Object(pe.a)(ue.a.mark(function t(n){return ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return ye.plugins.set("fs",e.bfs),t.next=3,ye.clone({dir:".",corsProxy:"https://cors.isomorphic-git.org",url:n,singleBranch:!0,depth:1});case 3:case"end":return t.stop()}},t,this)})),fetchCourse:Object(pe.a)(ue.a.mark(function t(n){var r,a;return ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return ye.plugins.set("fs",e.bfs),t.next=3,ye.clone({dir:".",corsProxy:"https://cors.isomorphic-git.org",url:n,singleBranch:!0,depth:1});case 3:return t.next=5,e.pfs.readFile("config.json");case 5:return r=t.sent,a=JSON.parse(r.toString()),e.course.setTitle(a.title),e.course.setDescription(a.description),e.course.setAuthor(a.author),e.course.setScenarioDirs(a.scenarios),t.next=13,e.course.fetchScenarios();case 13:case"end":return t.stop()}},t,this)}))}}),Oe=n(707),xe=n(300),ke=n.n(xe),Ee=n(80),Se=n.n(Ee),we=(n(692),n(693)),De=n(29);n(239);Se.a.locale("zh-cn");var Ce=je.create();Object(pe.d)(Ce,function(e){console.dir(JSON.stringify(e))}),we.configure({fs:"IndexedDB",options:{}},function(e){if(e)return console.log(e);var t=we.BFSRequire("fs"),n=De(t);Ce.setBfs(t),Ce.setPfs(n),o.a.render(a.a.createElement(D.a,{store:Ce},a.a.createElement(Oe.a,{locale:ke.a},a.a.createElement(se,null))),document.getElementById("root"))}),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[301,2,1]]]);
//# sourceMappingURL=main.305a5420.chunk.js.map