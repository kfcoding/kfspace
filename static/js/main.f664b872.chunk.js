(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{302:function(e,t,n){e.exports=n(699)},307:function(e,t,n){},309:function(e,t,n){},632:function(e,t){},648:function(e,t){},650:function(e,t){},654:function(e,t){},656:function(e,t){},658:function(e,t){},673:function(e,t){},675:function(e,t){},699:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(11),o=n.n(i),c=(n(307),n(12)),s=n(13),l=n(26),u=n(17),p=n(25),f=n(709),d=n(710),h=(n(309),n(170)),m=n.n(h),b=n(125),g=n.n(b),v=n(62),y=n.n(v),j=n(41),O=n.n(j),x=n(276),k=n.n(x),E=n(277),S=n.n(E),w=n(707),D=n(23),C=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a)))).state={title:"",description:""},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.scenario;return a.a.createElement(y.a.Item,null,a.a.createElement(y.a.Item.Meta,{title:e.title,description:e.description}),a.a.createElement("div",null,a.a.createElement(O.a,{type:"primary"},a.a.createElement(w.a,{to:"/scenarios/"+encodeURIComponent(this.props.sdir)},"\u5f00\u59cb\u5b9e\u8bad"))))}}]),t}(r.Component),T=(Object(D.b)("store")(C),function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a)))).state={title:"",author:"",description:"",scenarios:[],course:{}},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){}},{key:"goto",value:function(e){this.props.store.setCurrentScenario(e),this.props.store.setPage("scenario")}},{key:"render",value:function(){var e=this,t=this.props.store.course;return a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"banner"},a.a.createElement("h1",null,t.title),a.a.createElement("h2",null,"\u4f5c\u8005: ",t.author),a.a.createElement("h3",null,t.description)),a.a.createElement("div",{style:{padding:"40px 40px"}},a.a.createElement(m.a,{gutter:24},a.a.createElement(g.a,{span:18},a.a.createElement(y.a,null,t.scenarios.map(function(t){return a.a.createElement(y.a.Item,{key:t},a.a.createElement(y.a.Item.Meta,{title:t.title,description:t.description}),a.a.createElement("div",null,a.a.createElement(O.a,{type:"primary",onClick:function(){e.goto(t)}},"\u5f00\u59cb\u5b9e\u8bad")))}))),a.a.createElement(g.a,{span:6},a.a.createElement(k.a,{title:"\u8bfe\u7a0b\u4fe1\u606f"},a.a.createElement("div",null,"\u5b9e\u8bad\u6570\u91cf\uff1a",t.scenarios.length),"\u5b8c\u6210\u60c5\u51b5\uff1a",a.a.createElement(S.a,{type:"circle",percent:0}))))))}}]),t}(r.Component)),I=Object(D.b)("store")(Object(D.c)(T)),A=n(282),P=n.n(A),z=n(172),B=n.n(z),J=n(129),N=n.n(J),L=n(278),M=n.n(L),F=n(279),R=n.n(F),G=n(280),H=n.n(G);n(503);N.a.registerLanguage("js",R.a),N.a.registerLanguage("bash",H.a);var U=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return M()(this,e,t)}},{key:"render",value:function(){return a.a.createElement(N.a,{language:this.props.language||"js",value:this.props.value,inline:this.props.inline})}}]),t}(a.a.Component),q=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a)))).state={source:"123"},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{style:{}},a.a.createElement(B.a,{source:this.props.step.text,renderers:{inlineCode:U,code:U}}))}}]),t}(r.Component),W=Object(D.b)("store")(Object(D.c)(q)),$=n(281),K=n(174),Q=n.n(K),V=n(284),X=n.n(V),Y=n(30),Z=n.n(Y),_=(n(506),n(514),n(97)),ee=n(126);_.Terminal.applyAddon(ee);var te=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).resize=function(){},n.dom=a.a.createRef(),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.store.currentScenario.terminals[0].terminal.open(this.dom),this.props.store.currentScenario.terminals[0].terminal.fit()}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{ref:function(t){return e.dom=t},style:{width:"100%",height:"100%"}})}}]),t}(a.a.Component),ne=Object(D.b)("store")(te),re=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"modal",value:function(){P.a.info({title:this.props.store.currentScenario.title,content:a.a.createElement("div",null,this.props.store.currentScenario.description),onOk:function(){}})}},{key:"render",value:function(){var e=this,t=this.props.store.currentScenario;return a.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%"}},a.a.createElement("div",{style:{height:60,background:"#00b7ef",flexShrink:0}},a.a.createElement(Z.a,{type:"book",theme:"twoTone",style:{fontSize:40,lineHeight:"60px",cursor:"pointer"},onClick:function(){e.props.store.setPage("")}})),a.a.createElement("div",{style:{flexGrow:1,flexShrink:1,overflow:"hidden",position:"relative"}},a.a.createElement($.a,{split:"vertical",minSize:50,defaultSize:480,style:{}},a.a.createElement("div",{style:{height:"100%"}},a.a.createElement("div",{style:{height:40,lineHeight:"40px",textAlign:"center",fontSize:24,background:"#2f7aa7",color:"#fff"}},t.title),a.a.createElement("div",{style:{padding:20,overflow:"auto",height:"calc(100% - 60px)"}},t.steps.length>0&&a.a.createElement("div",{style:{height:"100%"}},a.a.createElement(W,{step:t.steps[this.props.store.stepIndex]}),a.a.createElement("div",{style:{textAlign:"right"}},a.a.createElement(O.a.Group,null,0!=this.props.store.stepIndex&&a.a.createElement(O.a,{type:"default",onClick:function(){e.props.store.prevStep()}},a.a.createElement(Z.a,{type:"left"}),"\u4e0a\u4e00\u6b65"),this.props.store.stepIndex!=t.steps.length-1&&a.a.createElement(O.a,{type:"primary",onClick:function(){e.props.store.nextStep()}},"\u4e0b\u4e00\u6b65",a.a.createElement(Z.a,{type:"right"}))))))),a.a.createElement("div",{style:{height:"100%"}},a.a.createElement(ne,null)))),a.a.createElement("div",{style:{background:"#fff",flexShrink:0,borderTop:"1px solid #ccc",paddingTop:20}},a.a.createElement(Q.a,{current:this.props.store.stepIndex+1,progressDot:function(e,n){n.status;var r=n.index;return a.a.createElement(X.a,{content:a.a.createElement("span",null,"\u7b2c",r,"\u6b65: ",t.steps[r-1].description)},e)},initial:1},t.steps.map(function(e){return a.a.createElement(Q.a.Step,{key:e,title:e.title})}))))}}]),t}(r.Component),ae=Object(D.b)("store")(Object(D.c)(re)),ie=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URLSearchParams(window.location.search).get("repo");this.props.store.fetchCourse(t).then(function(){e.props.store.setLoading(!1)})}},{key:"render",value:function(){return a.a.createElement("div",{style:{height:"100%"}},""==this.props.store.page?a.a.createElement(I,null):a.a.createElement(ae,null))}}]),t}(r.Component),oe=Object(D.b)("store")(Object(D.c)(ie)),ce=n(285),se=n.n(ce),le=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return a.a.createElement(se.a,{loading:this.props.store.loading,bgColor:"#39a189",spinnerColor:"#9ee5f8",textColor:"#fff",logoSrc:"http://kfcoding-static.oss-cn-hangzhou.aliyuncs.com/giphy.gif",text:"Loading...",style:{height:"100%"}},a.a.createElement(f.a,null,a.a.createElement("div",{style:{height:"100%"}},a.a.createElement(d.a,{path:"/kfspace",component:oe}))))}}]),t}(r.Component),ue=Object(D.b)("store")(Object(D.c)(le));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var pe=n(2),fe=n.n(pe),de=n(15),he=n(3),me=de.e.model("Step",{dir:"",title:"",description:"",text:""}).volatile(function(e){return{textDir:""}}).actions(function(e){return{afterCreate:function(){},setDir:function(t){e.dir=t},setTitle:function(t){e.title=t},setDescription:function(t){e.description=t},setTextDir:function(t){e.textDir=t},fetchText:Object(de.a)(fe.a.mark(function t(){var n;return fe.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(de.c)(e).pfs.readFile(Object(de.b)(Object(de.b)(e)).dir+"/"+e.dir+"/"+e.textDir);case 2:n=t.sent,e.text=n.toString();case 4:case"end":return t.stop()}},t,this)}))}}),be=n(173),ge=n.n(be);_.Terminal.applyAddon(ee);var ve=de.e.model("Terminal",{name:"tt"}).volatile(function(e){return{terminal:{}}}).views(function(e){return{get store(){return Object(de.c)(e)}}}).actions(function(e){var t=null,n=null;return{exc:function(t){var r,a=t.split(".");"cpp"===a[a.length-1]?r="g++ "+t+" -o /tmp/out.o && /tmp/out.o\n":"py"===a[a.length-1]?r="python "+t+"\n":alert("\u4e0d\u662f\u5408\u6cd5\u6587\u4ef6"),n.emit("term.input",{id:e.id,input:r})},afterCreate:function(){n=Object(de.b)(e,2).socket,t=new _.Terminal({fontSize:16}),e.terminal=t,t.on("key",function(e,t){n.emit("data",{host:"HOST1",data:e})}),t.on("resize",function(e){var t=e.cols,r=e.rows;n.emit("terminal-resize",{cols:t,rows:r})})},beforeDestroy:function(){n.emit("term.close",{id:e.id})}}}),ye=de.e.model("Scenario",{dir:de.e.identifier,title:"",description:"",steps:de.e.array(me),terminals:de.e.array(ve)}).volatile(function(e){return{stepDirs:[],socket:ge.a.connect("//ws.katacoda.com",{transports:["websocket"],timeout:12e4,reconnection:!1,query:"dockerimage=dind&course=docker&id=deploying-first-container&originalPathwayId="})}}).actions(function(e){Object(de.a)(fe.a.mark(function e(){var t,n;return fe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://api.kfcoding.com/api/basic/workspaces",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({dockerImage:"registry-vpc.cn-shanghai.aliyuncs.com/kfcoding/workspace-envs:ubuntu",type:"terminal"})});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,console.log(n);case 7:case"end":return e.stop()}},e,this)}));return{afterCreate:function(){e.terminals.push({}),e.socket.on("data",function(t){console.log(t),e.terminals[0].terminal.write(t.data)})},setDir:function(t){e.dir=t},setTitle:function(t){e.title=t},setDescription:function(t){e.description=t},setStepDirs:function(t){e.stepDirs=t},setTerminal:function(t){e.terminal=t},fetchSteps:Object(de.a)(fe.a.mark(function t(){var n,r,a,i,o;return fe.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=fe.a.keys(e.stepDirs);case 1:if((t.t1=t.t0()).done){t.next=21;break}return n=t.t1.value,t.prev=3,r=e.stepDirs[n],t.next=7,Object(de.c)(e).pfs.readFile(e.dir+"/"+r+"/config.json");case 7:return a=t.sent,i=JSON.parse(a.toString()),(o=me.create({dir:r,title:i.title,description:i.description})).setTextDir(i.text),e.steps.push(o),t.next=14,o.fetchText();case 14:t.next=19;break;case 16:t.prev=16,t.t2=t.catch(3),console.error(t.t2);case 19:t.next=1;break;case 21:case"end":return t.stop()}},t,this,[[3,16]])}))}}),je=de.e.model("Course",{title:"",description:"",author:"",scenarios:de.e.array(ye)}).volatile(function(e){return{scenarioDirs:[]}}).actions(function(e){return{afterCreate:function(){},setTitle:function(t){e.title=t},setDescription:function(t){e.description=t},setAuthor:function(t){e.author=t},addScenario:function(t){e.scenarios.push(t)},setScenarioDirs:function(t){e.scenarioDirs=t},fetchScenarios:Object(de.a)(fe.a.mark(function t(){var n,r,a,i,o;return fe.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.scenarios=[],t.t0=fe.a.keys(e.scenarioDirs);case 2:if((t.t1=t.t0()).done){t.next=20;break}return n=t.t1.value,t.prev=4,r=e.scenarioDirs[n],t.next=8,Object(de.c)(e).pfs.readFile(r+"/config.json");case 8:a=t.sent,i=JSON.parse(a.toString()),(o=ye.create({dir:r,title:i.title,description:i.description})).setStepDirs(i.steps),e.scenarios.push(o),t.next=18;break;case 15:t.prev=15,t.t2=t.catch(4),console.error(t.t2);case 18:t.next=2;break;case 20:Promise.all(e.scenarios.map(function(){var e=Object(he.a)(fe.a.mark(function e(t){return fe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchSteps();case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 21:case"end":return t.stop()}},t,this,[[4,15]])}))}}),Oe=n(239),xe=de.e.model("Store",{loading:!0,repo:"https://github.com/kfcoding/kfcoding-cource-example.git",course:de.e.optional(je,{}),hasCurrentScenario:!1,currentScenario:de.e.maybe(de.e.reference(ye)),stepIndex:0,currentStep:de.e.maybe(de.e.reference(me)),page:""}).volatile(function(e){return{bfs:null,pfs:null}}).actions(function(e){return{setBfs:function(t){e.bfs=t},setPfs:function(t){e.pfs=t},setRepo:function(t){e.repo=t},setCurrentScenario:function(t){e.currentScenario=t},setLoading:function(t){e.loading=t},setStepIndex:function(t){e.stepIndex=t},setPage:function(t){e.page=t},nextStep:function(){e.stepIndex++},prevStep:function(){e.stepIndex--},fetchGit:Object(de.a)(fe.a.mark(function t(n){return fe.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Oe.plugins.set("fs",e.bfs),t.next=3,Oe.clone({dir:".",corsProxy:"https://cors.isomorphic-git.org",url:n,singleBranch:!0,depth:1});case 3:case"end":return t.stop()}},t,this)})),fetchCourse:Object(de.a)(fe.a.mark(function t(n){var r,a;return fe.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Oe.plugins.set("fs",e.bfs),t.next=3,Oe.clone({dir:".",corsProxy:"https://cors.isomorphic-git.org",url:n,singleBranch:!0,depth:1});case 3:return t.next=5,e.pfs.readFile("config.json");case 5:return r=t.sent,a=JSON.parse(r.toString()),e.course.setTitle(a.title),e.course.setDescription(a.description),e.course.setAuthor(a.author),e.course.setScenarioDirs(a.scenarios),t.next=13,e.course.fetchScenarios();case 13:case"end":return t.stop()}},t,this)}))}}),ke=n(708),Ee=n(301),Se=n.n(Ee),we=n(80),De=n.n(we),Ce=(n(693),n(694)),Te=n(29);n(239);De.a.locale("zh-cn");var Ie=xe.create();Object(de.d)(Ie,function(e){console.dir(JSON.stringify(e))}),Ce.configure({fs:"IndexedDB",options:{}},function(e){if(e)return console.log(e);var t=Ce.BFSRequire("fs"),n=Te(t);Ie.setBfs(t),Ie.setPfs(n),o.a.render(a.a.createElement(D.a,{store:Ie},a.a.createElement(ke.a,{locale:Se.a},a.a.createElement(ue,null))),document.getElementById("root"))}),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[302,2,1]]]);
//# sourceMappingURL=main.f664b872.chunk.js.map